<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ase2sprkkr.common.options &mdash; ASE2SPRKKR  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/mods.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ASE2SPRKKR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">How to use the package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../how-to-install.html">More about the package installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../philosophy.html">Philosophy of the package (for developers)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="_static/slides.pdf#http://">Hastily written ASE2SPRKKR slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://ase2sprkkr.github.io/ase2sprkkr/">ASE2SPRKKR homepage</a></li>
<li class="toctree-l1"><a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE - atomic simulation environment</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ebert.cup.uni-muenchen.de/index.php/en/software-en/13-sprkkr">SPR-KKR</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ase2sprkkr/ase2sprkkr">GitHub repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/ase2sprkkr">PyPI package</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.ebert.cup.uni-muenchen.de/index.php/en/repository/func-startdown/251/lang,en-gb/">SPR-KKR manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Class documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../auto/ase2sprkkr.html">ase2sprkkr</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ASE2SPRKKR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ase2sprkkr.common.options</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ase2sprkkr.common.options</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; The classes for storing one configuration value. &quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">..common.grammar_types</span> <span class="kn">import</span> <span class="n">mixed</span><span class="p">,</span> <span class="n">GrammarType</span>
<span class="kn">from</span> <span class="nn">.configuration</span> <span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">from</span> <span class="nn">..common.misc</span> <span class="kn">import</span> <span class="n">as_integer</span>
<span class="kn">from</span> <span class="nn">.decorators</span> <span class="kn">import</span> <span class="n">warnings_from_here</span>


<div class="viewcode-block" id="DangerousValue"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.DangerousValue.html#ase2sprkkr.potentials.potential_definitions.DangerousValue">[docs]</a><span class="k">class</span> <span class="nc">DangerousValue</span><span class="p">:</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot; This class is used to store (encapsulate) a value, which should not be validated</span>
<span class="sd">  - to  overcame sometimes too strict enforment of the options values.</span>
<span class="sd">  &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DangerousValue.__init__"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.DangerousValue.html#ase2sprkkr.potentials.potential_definitions.DangerousValue.__init__">[docs]</a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value_type</span><span class="p">:</span><span class="n">GrammarType</span> <span class="o">|</span> <span class="kc">None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      value</span>
<span class="sd">        A value to be stored</span>

<span class="sd">      value_type</span>
<span class="sd">        A grammar type, that the value should satisfy (commonly a mixed type).</span>
<span class="sd">        Can be None - when the only requirement to the value is that it can be</span>
<span class="sd">        stringified.</span>

<span class="sd">      validate</span>
<span class="sd">        Should be the value validated or not (e.g. the value parsed by grammar</span>
<span class="sd">        has been already validated, so there is no need to do it again)</span>
<span class="sd">      &quot;&quot;&quot;</span>

      <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
          <span class="k">if</span> <span class="n">value_type</span><span class="p">:</span>
              <span class="n">value</span> <span class="o">=</span> <span class="n">value_type</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
              <span class="n">value_type</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">value_type</span> <span class="o">=</span> <span class="n">value_type</span></div>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return the actual value.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

<div class="viewcode-block" id="DangerousValue.write_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.DangerousValue.html#ase2sprkkr.potentials.potential_definitions.DangerousValue.write_value">[docs]</a>  <span class="k">def</span> <span class="nf">write_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_type</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">value_type</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BaseOption"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.BaseOption.html#ase2sprkkr.potentials.potential_definitions.BaseOption">[docs]</a><span class="k">class</span> <span class="nc">BaseOption</span><span class="p">(</span><span class="n">Configuration</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot; A base placeholder for a leaf element of a grammar file,</span>
<span class="sd">  both the a-value-holding ones (:class:`Option`) and</span>
<span class="sd">  dummy ones (Dummy)</span>
<span class="sd">  &quot;&quot;&quot;</span>
<div class="viewcode-block" id="BaseOption._save_to_file"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.BaseOption.html#ase2sprkkr.potentials.potential_definitions.BaseOption._save_to_file">[docs]</a>  <span class="k">def</span> <span class="nf">_save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name_in_grammar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Write the name-value pair to the given file, if the value</span>
<span class="sd">      is set. &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">output_definition</span><span class="o">.</span><span class="n">_save_to_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">always</span><span class="p">,</span> <span class="n">name_in_grammar</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseOption._find_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.BaseOption.html#ase2sprkkr.potentials.potential_definitions.BaseOption._find_value">[docs]</a>  <span class="k">def</span> <span class="nf">_find_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lower_case</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">has_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lower_case</span><span class="p">):</span>
         <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="BaseOption.get_path"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.BaseOption.html#ase2sprkkr.potentials.potential_definitions.BaseOption.get_path">[docs]</a>  <span class="k">def</span> <span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseOption.as_dict"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.BaseOption.html#ase2sprkkr.potentials.potential_definitions.BaseOption.as_dict">[docs]</a>  <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_changed</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">,</span> <span class="n">generated</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BaseOption.clear"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.BaseOption.html#ase2sprkkr.potentials.potential_definitions.BaseOption.clear">[docs]</a>  <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_not_check_required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">call_hooks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">generated</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
      <span class="k">pass</span></div></div>


<div class="viewcode-block" id="Dummy"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Dummy.html#ase2sprkkr.potentials.potential_definitions.Dummy">[docs]</a><span class="k">class</span> <span class="nc">Dummy</span><span class="p">(</span><span class="n">BaseOption</span><span class="p">):</span>

<div class="viewcode-block" id="Dummy.validate"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Dummy.html#ase2sprkkr.potentials.potential_definitions.Dummy.validate">[docs]</a>  <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">why</span><span class="o">=</span><span class="s1">&#39;save&#39;</span><span class="p">):</span>
      <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Dummy.has_any_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Dummy.html#ase2sprkkr.potentials.potential_definitions.Dummy.has_any_value">[docs]</a>  <span class="k">def</span> <span class="nf">has_any_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="kc">False</span></div>

  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;DUMMY </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&gt;&#39;</span></div>


<div class="viewcode-block" id="Option"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option">[docs]</a><span class="k">class</span> <span class="nc">Option</span><span class="p">(</span><span class="n">BaseOption</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot; Class for one option (a configuration value) of SPRKKR - either to</span>
<span class="sd">  be used as a part of InputParameters or Potential configuration.</span>
<span class="sd">  Usage:</span>

<span class="sd">  &gt;&gt;&gt; from ase2sprkkr.sprkkr.calculator import SPRKKR</span>
<span class="sd">  &gt;&gt;&gt; calculator = SPRKKR()</span>
<span class="sd">  &gt;&gt;&gt; conf = calculator.input_parameters</span>
<span class="sd">  &gt;&gt;&gt; conf.ENERGY.ImE = 5.</span>
<span class="sd">  &gt;&gt;&gt; conf.ENERGY.ImE()</span>
<span class="sd">  5.0</span>
<span class="sd">  &gt;&gt;&gt; conf.ENERGY.ImE.info</span>
<span class="sd">  &#39;Configuration value ImE&#39;</span>
<span class="sd">  &gt;&gt;&gt; conf.ENERGY.ImE.help()                     # doctest: +ELLIPSIS, +NORMALIZE_WHITESPACE</span>
<span class="sd">  Configuration value ImE</span>
<span class="sd">  &lt;BLANKLINE&gt;</span>
<span class="sd">  ImE : Energy (&lt;Real&gt; [Ry|eV]) ‚âù 0.0  (optional)</span>
<span class="sd">  &gt;&gt;&gt; conf.ENERGY.ImE.set_dangerous(&#39;1J&#39;)</span>
<span class="sd">  &gt;&gt;&gt; conf.ENERGY.ImE()</span>
<span class="sd">  &#39;1J&#39;</span>
<span class="sd">  &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Option.__init__"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.__init__">[docs]</a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">definition</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      definition: ValueDefinition</span>
<span class="sd">          The value type of the option and its format (in potential and/or task file)</span>

<span class="sd">      container:</span>
<span class="sd">          The container, that owns the object</span>

<span class="sd">      value: mixed</span>
<span class="sd">          The value of the option.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">definition</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_hook</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">enrich</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Return the value of the option.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      all_values: For numbered_array (see :class:`ConfigurationDefinition.is_numbered_array &lt;ConfigurationDefinition&gt;`,</span>
<span class="sd">      pass True as this argument to obtain array of all values. If False (the default) is given,</span>
<span class="sd">      only the &#39;wildcard&#39; value (i.e. the one without array index, which is used for the all values</span>
<span class="sd">      not explicitly specified) is returned.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span>
      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">getter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">)</span>

      <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_numbered_array</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">all_values</span><span class="p">:</span>
              <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;def&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">value</span>
      <span class="n">dv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_numbered_array</span> <span class="ow">and</span> <span class="n">all_values</span> <span class="ow">and</span> <span class="n">dv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;def&#39;</span> <span class="p">:</span> <span class="n">dv</span> <span class="p">}</span>
      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">init_by_default</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_value</span><span class="p">(</span> <span class="n">dv</span> <span class="p">)</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>

<div class="viewcode-block" id="Option.is_dangerous"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.is_dangerous">[docs]</a>  <span class="k">def</span> <span class="nf">is_dangerous</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return, whether the option is set to a dangerous value, i.e. a value</span>
<span class="sd">      that bypass the validation. &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">,</span> <span class="n">DangerousValue</span><span class="p">)</span></div>

<div class="viewcode-block" id="Option.set_dangerous"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.set_dangerous">[docs]</a>  <span class="k">def</span> <span class="nf">set_dangerous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Set the option to a dangerous value - i.e. to a value that bypass the</span>
<span class="sd">      type and value checks and enforcing.</span>

<span class="sd">      However, the type of such value is still checked by the proper mixed type.</span>
<span class="sd">      To completly bypass the check, set the value to an instance of DangerousValue</span>
<span class="sd">      class directly.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dangerous_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Option._create_dangerous_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._create_dangerous_value">[docs]</a>  <span class="k">def</span> <span class="nf">_create_dangerous_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">DangerousValue</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">type_of_dangerous</span><span class="p">)</span></div>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return default value for the option.</span>
<span class="sd">      The function is here, and not in the definition, since the default value can be given</span>
<span class="sd">      by callable, that accepts the Option as argument. This possibility is used in ase2sprkkr,</span>
<span class="sd">      when the default values of some options are generated from the underlined Atoms object</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Option.set"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.set">[docs]</a>  <span class="nd">@warnings_from_here</span><span class="p">(</span><span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">unknown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Set the value of the option.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      value: mixed</span>
<span class="sd">        The new value of the option.</span>

<span class="sd">      unknown: str or None</span>
<span class="sd">        A dummy argument to make the method compatibile with</span>
<span class="sd">        ase2sprkkr.sprkkr.common.configuration_containers.ConfigurationContainer.set()</span>

<span class="sd">      error:</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
              <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
          <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
              <span class="k">if</span> <span class="ow">not</span> <span class="n">error</span><span class="o">==</span><span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                  <span class="k">raise</span>
              <span class="k">return</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">do_not_check_required</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">call_hooks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
           <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
           <span class="k">try</span><span class="p">:</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="s1">&#39;def&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
           <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
               <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
             <span class="k">if</span> <span class="ow">not</span> <span class="n">error</span><span class="o">==</span><span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                  <span class="k">raise</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_post_set</span><span class="p">()</span></div>

<div class="viewcode-block" id="Option._post_set"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._post_set">[docs]</a>  <span class="k">def</span> <span class="nf">_post_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Thus should be called after all modifications &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_result&#39;</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hook</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Option.add_hook"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.add_hook">[docs]</a>  <span class="k">def</span> <span class="nf">add_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hook</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_hook</span> <span class="o">=</span> <span class="n">hook</span></div>

<div class="viewcode-block" id="Option._check_array_access"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._check_array_access">[docs]</a>  <span class="k">def</span> <span class="nf">_check_array_access</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Check, whether the option is numbered array and thus it can be accessed as array using [] &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">array_access</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;It is not allowed to access {self._get_path()} as array&#39;</span><span class="p">)</span></div>

  <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Set an item of a numbered array. If the Option is not a numbered array, throw an Exception. &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
          <span class="k">return</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">_check_array_access</span><span class="p">()</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
          <span class="bp">self</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">why</span><span class="o">=</span><span class="s1">&#39;set&#39;</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
           <span class="k">try</span><span class="p">:</span>
              <span class="n">cnt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
              <span class="n">step</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span>
              <span class="n">start</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">1</span>
              <span class="n">stop</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">stop</span> <span class="ow">or</span> <span class="n">start</span> <span class="o">+</span> <span class="n">step</span> <span class="o">*</span> <span class="n">cnt</span>
              <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">stop</span><span class="p">,</span><span class="n">step</span><span class="p">),</span> <span class="n">value</span><span class="p">):</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
           <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
              <span class="k">if</span> <span class="nb">slice</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                 <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;To get/set values in a numbered array using slice with one value, you have to specify the end index of the slice&quot;</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">):</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_post_set</span><span class="p">()</span>

<div class="viewcode-block" id="Option._set_item"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._set_item">[docs]</a>  <span class="k">def</span> <span class="nf">_set_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Set a single item of a numbered array. For internal use - so no sanity checks &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="p">{}</span>
      <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;def&#39;</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">as_integer</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Numbered array indexes can be only integers, lists or slices&#39;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
         <span class="k">if</span> <span class="n">name</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Numbered array indexes has to be greater than zero&#39;</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">!=</span><span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                <span class="k">raise</span></div>

  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Get an item of a numbered array. If the Option is not a numbered array, throw an Exception. &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">getter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_check_array_access</span><span class="p">()</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>

      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
          <span class="k">return</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span> <span class="p">]</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="n">stop</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="k">try</span><span class="p">:</span>
                  <span class="n">stop</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s1">&#39;def&#39;</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                  <span class="n">stop</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">),</span> <span class="n">stop</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
         <span class="k">return</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="p">]</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="Option._getitem"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._getitem">[docs]</a>  <span class="k">def</span> <span class="nf">_getitem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Get a single item from a numbered array. For internal use - so no sanity checks &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;def&#39;</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">as_integer</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Numbered array indexes can be only integers, lists or slices&#39;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
      <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span>
          <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
      <span class="k">elif</span> <span class="s1">&#39;def&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span>
          <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">[</span><span class="s1">&#39;def&#39;</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_value</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>

<div class="viewcode-block" id="Option._unpack_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._unpack_value">[docs]</a>  <span class="k">def</span> <span class="nf">_unpack_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Unpack potentionally dangerous values. &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">DangerousValue</span><span class="p">):</span>
         <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">()</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
         <span class="n">value</span> <span class="o">=</span> <span class="p">{</span> <span class="n">i</span><span class="p">:</span> <span class="n">v</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">DangerousValue</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
      <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Option._pack_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._pack_value">[docs]</a>  <span class="k">def</span> <span class="nf">_pack_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Validate the value, if it&#39;s to be. &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">DangerousValue</span><span class="p">):</span>
<span class="w">         </span><span class="sd">&quot;&quot;&quot; The dangerous value is immutable, checked during its creation &quot;&quot;&quot;</span>
         <span class="k">pass</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">convert_and_validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">value</span></div>

  <span class="k">def</span> <span class="nf">__hasitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_check_array_access</span><span class="p">()</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">()</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="kc">False</span>
      <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">value</span>

<div class="viewcode-block" id="Option.get"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.get">[docs]</a>  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return the value of self &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="p">()</span></div>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return the result value.</span>

<span class="sd">      In some cases, the value of an option have to be translated for the output.</span>
<span class="sd">      E.g. the site can be given as site object, but the integer index is</span>
<span class="sd">      required in the output.</span>

<span class="sd">      In a such case, this property can be utilized: the value of the option is</span>
<span class="sd">      retained as is and the transformed value is stored in the result.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_result&#39;</span><span class="p">):</span>
          <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">,</span> <span class="n">DangerousValue</span><span class="p">):</span>
              <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="o">.</span><span class="n">value</span>
          <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>
      <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">all_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="nd">@result</span><span class="o">.</span><span class="n">setter</span>
  <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="Option.clear_result"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.clear_result">[docs]</a>  <span class="k">def</span> <span class="nf">clear_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_result&#39;</span><span class="p">):</span>
          <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span></div>

<div class="viewcode-block" id="Option.clear"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.clear">[docs]</a>  <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_not_check_required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">call_hooks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">generated</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Clear the value: set it to None &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">generated</span><span class="p">:</span>
             <span class="k">return</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">setter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">has_value</span><span class="p">:</span>
             <span class="k">return</span>
          <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">default_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_not_check_required</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Option </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">()</span><span class="si">}</span><span class="s1"> must have a value&#39;</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="kc">None</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">clear_result</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">call_hooks</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_set</span><span class="p">()</span></div>

<div class="viewcode-block" id="Option.is_changed"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.is_changed">[docs]</a>  <span class="k">def</span> <span class="nf">is_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; True, if the value is set and the value differs from the default &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_and_changed</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Option.is_set"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.is_set">[docs]</a>  <span class="k">def</span> <span class="nf">is_set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; True, if the value is set (even equal to the default value) &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Option._written_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option._written_value">[docs]</a>  <span class="k">def</span> <span class="nf">_written_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      always:</span>
<span class="sd">        Skip all condition checking</span>

<span class="sd">      Returns</span>
<span class="sd">      -------</span>
<span class="sd">      write value: Any</span>
<span class="sd">        The value to be written</span>
<span class="sd">      write: bool,</span>
<span class="sd">        Whether to write the value or not</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">is_stored</span><span class="p">:</span>
          <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">always</span><span class="p">:</span>
          <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">condition</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
             <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">write_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
             <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">has_value</span><span class="p">:</span>
         <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dangerous</span><span class="p">():</span>
         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

      <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span>
      <span class="n">missing</span><span class="p">,</span><span class="n">_</span><span class="p">,</span> <span class="n">np</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">missing_value</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">value</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">and</span> <span class="n">np</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="kc">False</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">is_always_added</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_it_the_default_value</span><span class="p">(</span><span class="n">value</span><span class="p">)):</span>
          <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="kc">False</span>
      <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Option.validate"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.validate">[docs]</a>  <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">why</span><span class="o">=</span><span class="s1">&#39;save&#39;</span><span class="p">):</span>
      <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span>
      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_generated</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dangerous</span><span class="p">():</span>
         <span class="k">return</span>

      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">has_value</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">vali</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
             <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="o">.</span><span class="n">is_optional</span><span class="p">:</span>
                 <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_root_container</span><span class="p">()</span>
                 <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Value </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">()</span><span class="si">}</span><span class="s1"> is None and it is not an optional value. Therefore, I cannot save the </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
             <span class="n">d</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">why</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">why</span> <span class="o">==</span> <span class="s1">&#39;set&#39;</span><span class="p">:</span>
           <span class="n">vali</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
           <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span>
           <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                  <span class="n">vali</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
           <span class="k">else</span><span class="p">:</span>
              <span class="n">vali</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">name</span>

<div class="viewcode-block" id="Option.as_dict"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.as_dict">[docs]</a>  <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_changed</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">,</span> <span class="n">generated</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span>
      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_generated</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">generated</span><span class="p">:</span>
           <span class="k">return</span> <span class="kc">None</span>
      <span class="k">if</span> <span class="n">only_changed</span> <span class="ow">and</span> <span class="p">(</span><span class="n">only_changed</span><span class="o">!=</span><span class="s1">&#39;basic&#39;</span> <span class="ow">or</span> <span class="n">d</span><span class="o">.</span><span class="n">is_always_added</span><span class="p">):</span>
           <span class="n">v</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_and_changed</span><span class="p">()</span>
           <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
           <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">all_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
           <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">copy_value</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">all_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">v</span></div>

<div class="viewcode-block" id="Option.value_and_changed"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.value_and_changed">[docs]</a>  <span class="k">def</span> <span class="nf">value_and_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return value and whether the value was changed</span>

<span class="sd">          Returns</span>
<span class="sd">          -------</span>
<span class="sd">          value:mixed</span>
<span class="sd">            The value of the options (return all values for &#39;numbered array&#39;)</span>

<span class="sd">          changed:bool</span>
<span class="sd">            Whether the value is the same as the default value or not</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="p">(),</span> <span class="kc">False</span>

      <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_it_the_default_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
         <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;def&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span><span class="p">},</span> <span class="kc">False</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span><span class="p">,</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Option.is_it_the_default_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.is_it_the_default_value">[docs]</a>  <span class="k">def</span> <span class="nf">is_it_the_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Return, whether the given value is the default value. For</span>
<span class="sd">      numbered array, only the wildcard value can be set and this value</span>
<span class="sd">      have to be the same as the default. &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
          <span class="k">return</span> <span class="kc">True</span>

      <span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
      <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span>
      <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_numbered_array</span><span class="p">:</span>
          <span class="k">return</span> <span class="s1">&#39;def&#39;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
                  <span class="n">d</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">is_the_same_value</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;def&#39;</span><span class="p">],</span> <span class="n">default</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">is_the_same_value</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="Option.has_any_value"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.Option.html#ase2sprkkr.potentials.potential_definitions.Option.has_any_value">[docs]</a>  <span class="k">def</span> <span class="nf">has_any_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>

  <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>

  <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>

  <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="kc">True</span>

  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span><span class="p">:</span>
         <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Generated value </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">()</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
         <span class="n">o</span> <span class="o">=</span> <span class="kc">None</span>

      <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
         <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="s1">&#39;fn()&#39;</span>
         <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">o</span><span class="o">=</span><span class="s1">&#39; (default)&#39;</span>

      <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">o</span><span class="p">:</span>
           <span class="n">o</span><span class="o">=</span><span class="s1">&#39;out&#39;</span> <span class="o">+</span> <span class="n">o</span>
        <span class="k">else</span><span class="p">:</span>
           <span class="n">o</span><span class="o">=</span><span class="s1">&#39;out&#39;</span>
        <span class="n">v</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">o</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
         <span class="n">v</span><span class="o">=</span><span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">:</span>
           <span class="n">v</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s1">...</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span><span class="si">}</span><span class="s1">&#39;</span>

      <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;(generated)&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">is_generated</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;of type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&#39;</span>
      <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Option </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_path</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2"> with</span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="s2"> value</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&gt;&quot;</span></div>


<div class="viewcode-block" id="CustomOption"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.CustomOption.html#ase2sprkkr.potentials.potential_definitions.CustomOption">[docs]</a><span class="k">class</span> <span class="nc">CustomOption</span><span class="p">(</span><span class="n">Option</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot; An user-added option (configuration value). It can be removed from the section. &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CustomOption.remove"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.CustomOption.html#ase2sprkkr.potentials.potential_definitions.CustomOption.remove">[docs]</a>  <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Remove me from my &quot;parent&quot; section &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">remove_member</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CustomOption.factory"><a class="viewcode-back" href="../../../auto/ase2sprkkr.common.options.CustomOption.html#ase2sprkkr.potentials.potential_definitions.CustomOption.factory">[docs]</a>  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value_definition</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">mixed</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot; Returns factory function for the given value definition &quot;&quot;&quot;</span>

      <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">section</span><span class="p">):</span>
          <span class="n">definition</span> <span class="o">=</span> <span class="n">value_definition</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
          <span class="n">definition</span><span class="o">.</span><span class="n">removable</span> <span class="o">=</span> <span class="kc">True</span>
          <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">definition</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>

      <span class="n">create</span><span class="o">.</span><span class="n">grammar_type</span> <span class="o">=</span> <span class="nb">type</span>
      <span class="k">return</span> <span class="n">create</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Maty√°≈° Nov√°k &amp; Jano Min√°r.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>